var TheSupersonicPluginWrapper=function(h){"use strict";var $=Object.defineProperty;var P=(h,l,c)=>l in h?$(h,l,{enumerable:!0,configurable:!0,writable:!0,value:c}):h[l]=c;var s=(h,l,c)=>(P(h,typeof l!="symbol"?l+"":l,c),c);function l(a,t){return t=10**t,~~(a*t)/t}function c(a,t){let e;return function(){clearTimeout(e),e=setTimeout(()=>a.apply(this),t)}}function A(){return Math.random().toString(16).substring(2)}class E{constructor({id:t,cssAnimation:e,hooks:i,driver:o,domElement:r}){s(this,"id");s(this,"cssAnimation");s(this,"data",{});s(this,"driver");s(this,"domElement");s(this,"hooks");this.id=t,this.driver=o,this.cssAnimation=e,this.hooks=i,this.domElement=r,this.hooks.onInit&&this.hooks.onInit(this)}render({driverProgress:t}){let e=t*1e4;if(this.hooks.onBeforeRender){const i=this.hooks.onBeforeRender(this);if(typeof i=="number")e=i;else if(typeof i=="boolean"&&!i)return!1}this.cssAnimation.currentTime=e,this.hooks.onAfterRender&&this.hooks.onAfterRender(this)}}const u={colors:["red","blue","orange","yellow"],colorIndex:0};class g{constructor({id:t,start:e,end:i,plugin:o,elements:r=[],hooks:m={}}){s(this,"id");s(this,"progress",0);s(this,"data",{});s(this,"start");s(this,"end");s(this,"plugin");s(this,"animations",new Map);s(this,"helper");s(this,"hooks");this.id=t,this.plugin=o,this.hooks=m,this.hooks.onBeforeInit&&this.hooks.onBeforeInit(this),this.start=new b({domElement:e,type:"start",driver:this}),this.end=new b({domElement:i,type:"end",driver:this}),this.helper=new S({id:t,pluginId:this.plugin.id,debug:o.debug}),r.forEach(n=>{const f=typeof n=="string"?n:n.selector,v=Array.from(document.querySelectorAll(f));if(v.length===0)throw new Error(`Can't find element "${f}"`);v.forEach((R,x)=>{const k=R.getAnimations(),I=[];typeof n=="string"?(k.length,k.forEach(d=>{I.push({cssAnimation:d,hooks:{}})})):typeof n=="object"&&n.animations.forEach(d=>{let p="",y={};typeof d=="string"?p=d:typeof d=="object"&&(p=d.name,y=d.hooks);const w=k.find(z=>z.animationName===p);w&&I.push({cssAnimation:w,hooks:y})}),I.forEach(d=>{const p=`${this.id}---${f}---${x}---${d.cssAnimation.animationName}`,y=new E({id:p,driver:this,cssAnimation:d.cssAnimation,hooks:d.hooks,domElement:R});this.animations.set(p,y)})})}),this.hooks.onAfterInit&&this.hooks.onAfterInit(this)}render({scroll:t,renderedInitially:e,consoleColor:i="#000000"}){const o=this.progress;if(this.progress=this.calculateProgress({scroll:t,start:this.start.top,end:this.end.top}),this.hooks.onBeforeRender){const r=this.hooks.onBeforeRender(this);if(typeof r=="boolean"&&!r)return!1}if(o!==this.progress||!e){for(const r of this.animations.values())r.render({driverProgress:this.progress});this.hooks.onAfterRender&&this.hooks.onAfterRender(this)}}calculateProgress({scroll:t,start:e,end:i}){let o=(t-e)/(i-e);return o<0?o=0:o>1?o=1:o=l(o,4),o}updateLimits({scroll:t,screenHeight:e}){this.start.updateLimits({scroll:t,screenHeight:e}),this.end.updateLimits({scroll:t,screenHeight:e});const i=this.start.top+e;this.helper.updateLimits({top:i,height:this.end.top-i}),this.hooks.onUpdateLimits&&this.hooks.onUpdateLimits(this)}activate(){this.plugin.driverActiveInstances.add(this),this.hooks.onActivation&&this.hooks.onActivation(this)}deactivate(){this.plugin.driverActiveInstances.delete(this),this.hooks.onDeactivation&&this.hooks.onDeactivation(this)}}class b{constructor({domElement:t,type:e,driver:i}){s(this,"domElement");s(this,"top",0);if(typeof t=="string"&&(t=document.querySelector(t)),!t)throw new Error(`Can't find "${e}" HTMLElement for driver "${i.id}"`);this.domElement=t}updateLimits({scroll:t,screenHeight:e}){this.top=~~this.domElement.getBoundingClientRect().top+t-e}}class S{constructor({id:t,pluginId:e,debug:i=!1}){s(this,"domElement");s(this,"pluginId");s(this,"debug");if(this.pluginId=e,this.debug=i,this.domElement=document.createElement("i"),this.domElement.style.position="absolute",this.domElement.style.left="0",this.domElement.style.width="1px",this.domElement.setAttribute("data-supersonic-driver",t),this.domElement.setAttribute("data-supersonic-type","helper"),this.domElement.setAttribute("data-supersonic-plugin-id",this.pluginId),this.domElement.classList.add("supersonic-helper"),document.body.appendChild(this.domElement),i){const r=Array.from(document.querySelectorAll("[data-supersonic-type='helper']")).indexOf(this.domElement);this.domElement.style.left=`${r*10}px`,this.domElement.style.width="10px",this.domElement.style.minHeight="50px",this.domElement.style.background=u.colors[u.colorIndex],this.domElement.style.zIndex="100000",u.colorIndex===3?u.colorIndex=0:u.colorIndex++,this.domElement.style.opacity="0.75"}}updateLimits({top:t,height:e}){e<=0&&(e=1),this.domElement.style.setProperty("top",`${t}px`),this.domElement.style.setProperty("height",`${e}px`)}uninit(){this.domElement.remove()}}class B{constructor({observables:t,driverInstances:e}){s(this,"instance");this.instance=new IntersectionObserver(i=>{i.forEach(o=>{const m=o.target.dataset.supersonicDriver,n=e.get(m);if(!n)throw new Error(`Observer can't find driver "${m}"`);o.isIntersecting?n.activate():n.deactivate()})}),t.forEach(i=>{this.instance.observe(i)})}uninit(){this.instance.disconnect()}}class L{constructor(t,e){s(this,"id");s(this,"scroll",0);s(this,"screenHeight",0);s(this,"renderedInitially",!1);s(this,"rafId",0);s(this,"consoleColor","#ffffff");s(this,"observer",null);s(this,"onResize",null);s(this,"data",{});s(this,"debug");s(this,"hooks",{});s(this,"driverInstances",new Map);s(this,"driverActiveInstances",new Set);var r,m;this.id=(e==null?void 0:e.id)??A(),this.hooks=(e==null?void 0:e.hooks)??{},this.debug=(e==null?void 0:e.debug)??!1,(r=this.hooks)!=null&&r.onBeforeInit&&this.hooks.onBeforeInit(this),t.forEach(n=>{const f=n.id??A(),v=new g({id:f,hooks:n.hooks,start:n.start,end:n.end,elements:n.elements,plugin:this});this.driverInstances.set(f,v)}),this.updateLimits();const i=Array.from(document.querySelectorAll(`[data-supersonic-type="helper"][data-supersonic-plugin-id="${this.id}"]`));this.observer=new B({observables:i,driverInstances:this.driverInstances});const o=()=>{var n;(n=this.hooks)!=null&&n.onBeforeResize&&this.hooks.onBeforeResize(this),this.updateLimits(),this.render({useActiveDrivers:!1}),this.hooks.onAfterResize&&this.hooks.onAfterResize(this)};this.onResize=c(o,250),window.addEventListener("resize",this.onResize),this.render({useActiveDrivers:!1}),this.renderedInitially=!0,(m=this.hooks)!=null&&m.onAfterInit&&this.hooks.onAfterInit(this)}uninit(){for(const t of this.driverInstances.values())t.helper.uninit();this.driverInstances.clear(),this.driverActiveInstances.clear(),this.observer.uninit(),cancelAnimationFrame(this.rafId),window.removeEventListener("resize",this.onResize)}render({useActiveDrivers:t}){if(this.updateScroll(),this.hooks.onBeforeRender){const i=this.hooks.onBeforeRender(this);if(typeof i=="boolean"&&!i)return!1}const e=t?this.driverActiveInstances.values():this.driverInstances.values();for(const i of e)i.render({scroll:this.scroll,renderedInitially:this.renderedInitially,consoleColor:this.consoleColor});this.rafId=requestAnimationFrame(()=>{this.render({useActiveDrivers:!0})}),this.hooks.onAfterRender&&this.hooks.onAfterRender(this)}updateLimits(){this.updateScreenHeight(),this.updateScroll();for(const t of this.driverInstances.values())t.updateLimits({scroll:this.scroll,screenHeight:this.screenHeight})}updateScroll(){this.scroll=window.scrollY||document.documentElement.scrollTop}updateScreenHeight(){const t={position:"absolute",left:"0",top:"0",height:"100vh",width:"1px",zIndex:"-1",visibility:"hidden"},e=document.createElement("div");for(const i in t)e.style.setProperty(i,t[i]);document.body.appendChild(e),this.screenHeight=e.clientHeight,e.remove()}}return h.Animation=E,h.Driver=g,h.TheSupersonicPlugin=L,Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}),h}({});
